# オンラインチャットシステム

・C/Sモデルを使って、TCP通信をベースにチャットをプログラムし、サーバー転送によりチャットの機能を実現できるようにした。  
・クライアントパッケージ、サーバーパッケージ、コモンパッケージの3つに分ける。

## システム説明
  
 ・このシステムはTCP通信をベースとし、クライアントとサーバーが同時にアクセスできるクライアント・サーバーモデルを使う。  
 ・スレッド技術により、複数ユーザーが同時にオンラインできることで、システムの並行性を高め、実用性を高めている。  
 ・シンプルなクライアント画面があり、メッセージ配信の安定性と一貫性を確保するため、信頼性の高いTCP通信を使用している。

## システム機能  

  - クライアントがユーザー名を入力し、ログインする。  
  - サーバーがログイン情報を確認する。  
  - クライアント間の全員チャット  
  - クライアント間の個別チャット  
  - オンラインリストの動的な更新  
  - オンライン人数を表示  
  - クライアントログアウト処理  
  - クライアントオンライン、オフラインアラーム  
  - クライアントファイル転送
  
## Demo 
- 登録精査  
![](https://user-images.githubusercontent.com/108509511/208335136-0af5c656-943a-46c9-877c-41a32d978c37.png)

- クライアントウィンドウ  
![スクリーンショット (117)](https://user-images.githubusercontent.com/108509511/208336893-4fcb8bad-1a47-4050-90ee-d7ee362804c7.png)

- 全員に送信する  
![スクリーンショット (118)](https://user-images.githubusercontent.com/108509511/208336955-043eede5-828d-4f7e-b79a-adcf76a0b84b.png)

- 個別送信、ファイル添付  
![スクリーンショット (119)](https://user-images.githubusercontent.com/108509511/208337125-30696f5b-b5bb-47fc-b0c1-0aebff452cdd.png)

- 退室  
![スクリーンショット (120)](https://user-images.githubusercontent.com/108509511/208337136-bb909ca2-0d61-48ae-85b3-0dd9b0fd0c5d.png)

## パッケージ機能説明 

・クライアント側：    
  (1)ログイン機能：ユーザーは登録後、サーバーを選択してチャットルームにログインすることができる。    
  (2)ユーザーを表示する：オンラインユーザーをリストに表示する。    
  (3)メッセージ受信：他のユーザーからのメッセージを受信する機能。    
  (4)メッセージの送信：ユーザーがメッセージを送信する機能。  
  
・サーバー側:  
  (1)ログイン情報精査：ログイン情報が正しいかどうかを確認し、正しい場合はログイン情報をクライアントに返却する。ユーザーのログインが許可される。　　  
  (2)オンライン人数を表示する：オンライン中の各ユーザーにオンライン人数を送信する。  
  (3)チャットメッセージの転送：オンライン中の全ユーザーにメッセージを転送する。  
  
 ・コモンパッケージ：  
  (1)メッセージタイプを定義する。  
  (2)メッセージ転送メソッドを提供する。  
  
 ## 開発環境
 - Windows
 - Eclipse
 - JavaSE17
 
 ## モジュール説明
・クライアント  
Clientモジュール：サーバー側との接続を確立し、クライアントログインを完了し、全員チャット、個別チャット、ユーザーリスト更新、ファイル変換などの機能を実現する。  
ClientUIモジュール：クライアントウィンドウのインターフェース、メッセージ表示、ユーザーリスト、メッセージタイプ、オンライン人数、その他の情報をウィンドウに表示する。  
ClientMsgTypeモジュール：共通のメッセージ処理方式を定義する。  

・サーバー  
Serverモジュール：リスナーを起動し、クライアントとの接続を確立する。  
ServerHandlerモジュール：スレッド管理を行い、複数ユーザーの管理可能、各ユーザーが送信したメッセージは、適宜処理された後、クライアントに転送される。  
ServerMsgTypeモジュール：クライアントから送信されたメッセージを処理し、メッセージのみを転送する。1対多と1対1の2つのモードがある。  

・Common  
Messageクラス：クライアントとサーバーが転送するメッセージをクラスとして定義し、Messageオブジェクトのシリアライズにより転送する。  
Commonクラス：ファイルシリアライズの処理と共通機能関数を提供する。
Configクラス：接続先のIPとポート番号に関する設定情報を含む。  

## インストール
$ git clone https://github.com/le-wangyuting/chat.git

## 使い方  
(1)プロジェクトをダウンロードし、ロカールに保存する。  
(2)serviceフォルダを開いて、Server.javaを起動する。  
(3)clientフォルダを開いて、Client.javaを起動する。

## まとめ  
 　今回はJavaを使ってTCP通信を利用するチャットシステムを実現した。最初に設計したプログラムは、クライアントとサーバーの間だけの通信ができるなものでした。その後、同時アクセスは実装されていないことが判明した。そして、調べたらクライアント側の処理をスレッド化し、複数のクライアントがオンラインで同時に応答できるようにした。そこで、Javaのオブジェクトのシリアライズを利用してMessageクラスに統一し、オブジェクトの入出力ストリームを使ってクライアントとサーバーの間で転送するようにしました。

 　また技術力が不足しているため、まだ実現できないことがある。  
・クライアントウィンドウは、時間の関係でシンプルになりすぎてしまい、丁寧に設計していなかった。  
・クライアントとサーバー間のメッセージ転送のセキュリティチェックは対象外であった。  
・データベースは使用せず、チャットメッセージは保存されているはず。    

 
